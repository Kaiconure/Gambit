{
  "about": {
    "author": "@Kaiconure",
    "notes": [
      "Place this at the very top of your battle section, or at least above any gambit that will turn or move toward the mob.",
      "This will cause you to turn and face away from the mob when certain abilities are being used, and then turn when usage completes."
    ]
  },
  "vars": {
    "face_away_on_ability": {
      "abilities": null,
      "mobs": null,
      "triggered": false
    }
  },
  "actions": [
    {
      "commands": ["setVar('vars.face_away_on_ability.triggered', false)"],
      "delay": 0,
      "frequency": "infinity",
      "scope": "battle",
      "comment": "This will run exactly once at the start of any battle, and ensure that the face_away_on_ability.triggered flag is initially cleared."
    },
    {
      "when": [
        "vars.face_away_on_ability.triggered",
        "not enemyUsingAbility()"
      ],
      "commands": [
        "setVar('vars.face_away_on_ability.triggered', false)",
        "log('====== END ABILITY FACE-AWAY SEQUENCE ====== ')"
      ],
      "delay": 0
    },
    {
      "when": [
        "not vars.face_away_on_ability.triggered",
        "enemyUsingAbility(vars.face_away_on_ability.abilities)",
        "arrayLength(vars.face_away_on_ability.mobs) == 0 or any(bt.name, vars.face_away_on_ability.mobs)"
      ],
      "commands": [
        "faceAway(bt)",
        "setVar('vars.face_away_on_ability.triggered', true)",
        "log('====== BEGIN ABILITY FACE-AWAY SEQUENCE ====== ')",
        "wait(1)"
      ],
      "delay": 0
    },
    {
      "when": ["vars.face_away_on_ability.triggered", "not bt"],
      "commands": [
        "setVar('vars.face_away_on_spell.triggered', false)",
        "log('====== END ABILITY FACE-AWAY SEQUENCE [NO BT] ====== ')"
      ],
      "delay": 0
    },
    {
      "when": "vars.face_away_on_ability.triggered",
      "commands": [
        "log('Continuing ability face away...')",
        "faceAway(bt)",
        "wait(1)"
      ],
      "delay": 0
    }
  ]
}
